function collectFiles (accessToken) {
  var dbox = require('dbox'),
      _ = require('underscore');
	var APP_KEY = '7a870efg25be689',
      APP_SECRET = '0ly99wm2hgau5qq';

  var app = dbox.app({
      'app_key': APP_KEY,
      'app_secret': APP_SECRET
  });
  var client = app.client(accessToken)
  var options = {
    'file_limit'         : 10000,              // optional
    'list'               : true,               // optional
    'include_deleted'    : false,              // optional
    'locale'             : "en",               // optional
    'root'               : "dropbox"           // optional
  }
  var links = new Array();
  client.metadata("", options, function(status, reply){
    for (var i =0; i<reply['contents'].length; ++i){
      console.log(reply['contents'][i]['path']);
      client.shares(reply['contents'][i]['path'], {'root': 'dropbox'}, function(status, reply_sh){
        console.log(reply_sh['url']);
        links.push(reply_sh['url']);
      });
    }
  });
  return links;
  
}

module.exports = collectFiles;